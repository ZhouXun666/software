{"ast":null,"code":"import { userAPI } from '../api';\nexport default {\n  name: 'UserUpdate',\n  data() {\n    return {\n      userForm: {\n        username: '',\n        name: '',\n        gender: '0',\n        email: '',\n        phone: ''\n      },\n      userRules: {\n        name: [{\n          required: false,\n          max: 50,\n          message: '昵称不能超过50个字符',\n          trigger: 'blur'\n        }],\n        email: [{\n          required: false,\n          type: 'email',\n          message: '请输入正确的邮箱地址',\n          trigger: 'blur'\n        }],\n        phone: [{\n          required: false,\n          pattern: /^1[3-9]\\d{9}$/,\n          message: '请输入正确的手机号码',\n          trigger: 'blur'\n        }],\n        bio: [{\n          required: false,\n          max: 200,\n          message: '个性签名不能超过200个字符',\n          trigger: 'blur'\n        }]\n      },\n      submitting: false\n    };\n  },\n  mounted() {\n    this.loadUserInfo();\n  },\n  methods: {\n    async loadUserInfo() {\n      try {\n        //获得当前用户的id\n        const userInfoString = localStorage.getItem('userInfo');\n        const userInfo = JSON.parse(userInfoString);\n        const id = userInfo.id;\n        const response = await userAPI.getUserInfo(id);\n        this.userForm = {\n          username: response.username,\n          name: response.name || '',\n          gender: response.gender?.toString() || '0',\n          email: response.email || '',\n          phone: response.phone || ''\n        };\n      } catch (error) {\n        this.$message.error('加载用户信息失败');\n      }\n    },\n    async submitForm() {\n      this.$refs.userFormRef.validate(async valid => {\n        if (valid) {\n          this.submitting = true;\n          try {\n            //获得当前用户的id\n            const userInfoString = localStorage.getItem('userInfo');\n            const userInfo = JSON.parse(userInfoString);\n            const id = userInfo.id;\n            await userAPI.updateUserInfo(id, this.userForm);\n            this.$message.success('个人信息更新成功');\n            this.$router.push('/user/info');\n          } catch (error) {\n            this.$message.error('更新失败，请重试');\n          } finally {\n            this.submitting = false;\n          }\n        }\n      });\n    },\n    resetForm() {\n      this.$refs.userFormRef.resetFields();\n    },\n    goBack() {\n      this.$router.go(-1);\n    }\n  }\n};","map":{"version":3,"names":["userAPI","name","data","userForm","username","gender","email","phone","userRules","required","max","message","trigger","type","pattern","bio","submitting","mounted","loadUserInfo","methods","userInfoString","localStorage","getItem","userInfo","JSON","parse","id","response","getUserInfo","toString","error","$message","submitForm","$refs","userFormRef","validate","valid","updateUserInfo","success","$router","push","resetForm","resetFields","goBack","go"],"sources":["D:\\文档\\学习\\专业课实验报告书\\专业选修\\软件工程\\version1\\frontend\\src\\views\\UserUpdate.vue"],"sourcesContent":["<template>\n  <div class=\"user-update-container\">\n    <el-card class=\"update-card\">\n      <template #header>\n        <div class=\"card-header\">\n          <span>编辑个人信息</span>\n        </div>\n      </template>\n      \n      <el-form :model=\"userForm\" :rules=\"userRules\" ref=\"userFormRef\" label-width=\"100px\" class=\"update-form\">\n        <el-form-item label=\"用户名\" prop=\"username\">\n          <el-input v-model=\"userForm.username\" disabled placeholder=\"用户名不可修改\" />\n        </el-form-item>\n        \n        <el-form-item label=\"昵称\" prop=\"name\">\n          <el-input v-model=\"userForm.name\" placeholder=\"请输入昵称\" maxlength=\"50\" show-word-limit />\n        </el-form-item>\n        \n        <el-form-item label=\"性别\">\n          <el-radio-group v-model=\"userForm.gender\">\n            <el-radio label=\"1\">男</el-radio>\n            <el-radio label=\"2\">女</el-radio>\n            <el-radio label=\"3\">保密</el-radio>\n          </el-radio-group>\n        </el-form-item>\n        \n        <el-form-item label=\"邮箱\" prop=\"email\">\n          <el-input v-model=\"userForm.email\" type=\"email\" placeholder=\"请输入邮箱\" maxlength=\"100\" show-word-limit />\n        </el-form-item>\n        \n        <el-form-item label=\"手机号码\" prop=\"phone\">\n          <el-input v-model=\"userForm.phone\" placeholder=\"请输入手机号码\" maxlength=\"20\" show-word-limit />\n        </el-form-item>\n        \n        <el-form-item>\n          <el-button type=\"primary\" @click=\"submitForm\" :loading=\"submitting\">保存修改</el-button>\n          <el-button @click=\"resetForm\">重置</el-button>\n          <el-button @click=\"goBack\">返回</el-button>\n        </el-form-item>\n      </el-form>\n    </el-card>\n  </div>\n</template>\n\n<script>\nimport { userAPI } from '../api'\n\nexport default {\n  name: 'UserUpdate',\n  data() {\n    return {\n      userForm: {\n        username: '',\n        name: '',\n        gender: '0',\n        email: '',\n        phone: '',\n      },\n      userRules: {\n        name: [\n          { required: false, max: 50, message: '昵称不能超过50个字符', trigger: 'blur' }\n        ],\n        email: [\n          { required: false, type: 'email', message: '请输入正确的邮箱地址', trigger: 'blur' }\n        ],\n        phone: [\n          { required: false, pattern: /^1[3-9]\\d{9}$/, message: '请输入正确的手机号码', trigger: 'blur' }\n        ],\n        bio: [\n          { required: false, max: 200, message: '个性签名不能超过200个字符', trigger: 'blur' }\n        ]\n      },\n      submitting: false\n    }\n  },\n  mounted() {\n    this.loadUserInfo()\n  },\n  methods: {\n    async loadUserInfo() {\n      try {\n        //获得当前用户的id\n        const userInfoString = localStorage.getItem('userInfo');\n        const userInfo = JSON.parse(userInfoString);\n        const id = userInfo.id;\n        const response = await userAPI.getUserInfo(id)\n        this.userForm = {\n          username: response.username,\n          name: response.name || '',\n          gender: response.gender?.toString() || '0',\n          email: response.email || '',\n          phone: response.phone || '',\n        }\n      } catch (error) {\n        this.$message.error('加载用户信息失败')\n      }\n    },\n    async submitForm() {\n      this.$refs.userFormRef.validate(async (valid) => {\n        if (valid) {\n          this.submitting = true\n          try {\n            //获得当前用户的id\n            const userInfoString = localStorage.getItem('userInfo');\n            const userInfo = JSON.parse(userInfoString);\n            const id = userInfo.id;\n            await userAPI.updateUserInfo(id,this.userForm)\n            this.$message.success('个人信息更新成功')\n            this.$router.push('/user/info')\n          } catch (error) {\n            this.$message.error('更新失败，请重试')\n          } finally {\n            this.submitting = false\n          }\n        }\n      })\n    },\n    resetForm() {\n      this.$refs.userFormRef.resetFields()\n    },\n    goBack() {\n      this.$router.go(-1)\n    }\n  }\n}\n</script>\n\n<style scoped>\n.user-update-container {\n  padding: 0;\n}\n\n.update-card {\n  max-width: 600px;\n  margin: 0 auto;\n}\n\n.card-header {\n  font-size: 18px;\n  font-weight: 500;\n  color: #303133;\n}\n\n.update-form {\n  padding-top: 20px;\n}\n\n@media (max-width: 768px) {\n  .update-card {\n    max-width: 100%;\n  }\n  \n  .el-form {\n    width: 80px;\n  }\n}\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}