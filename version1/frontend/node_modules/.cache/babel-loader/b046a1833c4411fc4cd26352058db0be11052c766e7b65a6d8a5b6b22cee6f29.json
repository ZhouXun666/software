{"ast":null,"code":"import { createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"user-update-container\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_input = _resolveComponent(\"el-input\");\n  const _component_el_form_item = _resolveComponent(\"el-form-item\");\n  const _component_el_radio = _resolveComponent(\"el-radio\");\n  const _component_el_radio_group = _resolveComponent(\"el-radio-group\");\n  const _component_el_button = _resolveComponent(\"el-button\");\n  const _component_el_form = _resolveComponent(\"el-form\");\n  const _component_el_card = _resolveComponent(\"el-card\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createVNode(_component_el_card, {\n    class: \"update-card\"\n  }, {\n    header: _withCtx(() => [...(_cache[5] || (_cache[5] = [_createElementVNode(\"div\", {\n      class: \"card-header\"\n    }, [_createElementVNode(\"span\", null, \"编辑个人信息\")], -1 /* CACHED */)]))]),\n    default: _withCtx(() => [_createVNode(_component_el_form, {\n      model: $data.userForm,\n      rules: $data.userRules,\n      ref: \"userFormRef\",\n      \"label-width\": \"100px\",\n      class: \"update-form\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_form_item, {\n        label: \"用户名\",\n        prop: \"username\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_input, {\n          modelValue: $data.userForm.username,\n          \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.userForm.username = $event),\n          disabled: \"\",\n          placeholder: \"用户名不可修改\"\n        }, null, 8 /* PROPS */, [\"modelValue\"])]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_form_item, {\n        label: \"昵称\",\n        prop: \"name\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_input, {\n          modelValue: $data.userForm.name,\n          \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $data.userForm.name = $event),\n          placeholder: \"请输入昵称\",\n          maxlength: \"50\",\n          \"show-word-limit\": \"\"\n        }, null, 8 /* PROPS */, [\"modelValue\"])]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_form_item, {\n        label: \"性别\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_radio_group, {\n          modelValue: $data.userForm.gender,\n          \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $data.userForm.gender = $event)\n        }, {\n          default: _withCtx(() => [_createVNode(_component_el_radio, {\n            label: \"1\"\n          }, {\n            default: _withCtx(() => [...(_cache[6] || (_cache[6] = [_createTextVNode(\"男\", -1 /* CACHED */)]))]),\n            _: 1 /* STABLE */\n          }), _createVNode(_component_el_radio, {\n            label: \"2\"\n          }, {\n            default: _withCtx(() => [...(_cache[7] || (_cache[7] = [_createTextVNode(\"女\", -1 /* CACHED */)]))]),\n            _: 1 /* STABLE */\n          }), _createVNode(_component_el_radio, {\n            label: \"3\"\n          }, {\n            default: _withCtx(() => [...(_cache[8] || (_cache[8] = [_createTextVNode(\"保密\", -1 /* CACHED */)]))]),\n            _: 1 /* STABLE */\n          })]),\n          _: 1 /* STABLE */\n        }, 8 /* PROPS */, [\"modelValue\"])]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_form_item, {\n        label: \"邮箱\",\n        prop: \"email\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_input, {\n          modelValue: $data.userForm.email,\n          \"onUpdate:modelValue\": _cache[3] || (_cache[3] = $event => $data.userForm.email = $event),\n          type: \"email\",\n          placeholder: \"请输入邮箱\",\n          maxlength: \"100\",\n          \"show-word-limit\": \"\"\n        }, null, 8 /* PROPS */, [\"modelValue\"])]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_form_item, {\n        label: \"手机号码\",\n        prop: \"phone\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_input, {\n          modelValue: $data.userForm.phone,\n          \"onUpdate:modelValue\": _cache[4] || (_cache[4] = $event => $data.userForm.phone = $event),\n          placeholder: \"请输入手机号码\",\n          maxlength: \"20\",\n          \"show-word-limit\": \"\"\n        }, null, 8 /* PROPS */, [\"modelValue\"])]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_form_item, null, {\n        default: _withCtx(() => [_createVNode(_component_el_button, {\n          type: \"primary\",\n          onClick: $options.submitForm,\n          loading: $data.submitting\n        }, {\n          default: _withCtx(() => [...(_cache[9] || (_cache[9] = [_createTextVNode(\"保存修改\", -1 /* CACHED */)]))]),\n          _: 1 /* STABLE */\n        }, 8 /* PROPS */, [\"onClick\", \"loading\"]), _createVNode(_component_el_button, {\n          onClick: $options.resetForm\n        }, {\n          default: _withCtx(() => [...(_cache[10] || (_cache[10] = [_createTextVNode(\"重置\", -1 /* CACHED */)]))]),\n          _: 1 /* STABLE */\n        }, 8 /* PROPS */, [\"onClick\"]), _createVNode(_component_el_button, {\n          onClick: $options.goBack\n        }, {\n          default: _withCtx(() => [...(_cache[11] || (_cache[11] = [_createTextVNode(\"返回\", -1 /* CACHED */)]))]),\n          _: 1 /* STABLE */\n        }, 8 /* PROPS */, [\"onClick\"])]),\n        _: 1 /* STABLE */\n      })]),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"model\", \"rules\"])]),\n    _: 1 /* STABLE */\n  })]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createVNode","_component_el_card","header","_withCtx","_cache","_createElementVNode","_component_el_form","model","$data","userForm","rules","userRules","ref","_component_el_form_item","label","prop","_component_el_input","username","$event","disabled","placeholder","name","maxlength","_component_el_radio_group","gender","_component_el_radio","email","type","phone","_component_el_button","onClick","$options","submitForm","loading","submitting","resetForm","goBack"],"sources":["D:\\文档\\学习\\专业课实验报告书\\专业选修\\软件工程\\version1\\frontend\\src\\views\\UserUpdate.vue"],"sourcesContent":["<template>\n  <div class=\"user-update-container\">\n    <el-card class=\"update-card\">\n      <template #header>\n        <div class=\"card-header\">\n          <span>编辑个人信息</span>\n        </div>\n      </template>\n      \n      <el-form :model=\"userForm\" :rules=\"userRules\" ref=\"userFormRef\" label-width=\"100px\" class=\"update-form\">\n        <el-form-item label=\"用户名\" prop=\"username\">\n          <el-input v-model=\"userForm.username\" disabled placeholder=\"用户名不可修改\" />\n        </el-form-item>\n        \n        <el-form-item label=\"昵称\" prop=\"name\">\n          <el-input v-model=\"userForm.name\" placeholder=\"请输入昵称\" maxlength=\"50\" show-word-limit />\n        </el-form-item>\n        \n        <el-form-item label=\"性别\">\n          <el-radio-group v-model=\"userForm.gender\">\n            <el-radio label=\"1\">男</el-radio>\n            <el-radio label=\"2\">女</el-radio>\n            <el-radio label=\"3\">保密</el-radio>\n          </el-radio-group>\n        </el-form-item>\n        \n        <el-form-item label=\"邮箱\" prop=\"email\">\n          <el-input v-model=\"userForm.email\" type=\"email\" placeholder=\"请输入邮箱\" maxlength=\"100\" show-word-limit />\n        </el-form-item>\n        \n        <el-form-item label=\"手机号码\" prop=\"phone\">\n          <el-input v-model=\"userForm.phone\" placeholder=\"请输入手机号码\" maxlength=\"20\" show-word-limit />\n        </el-form-item>\n        \n        <el-form-item>\n          <el-button type=\"primary\" @click=\"submitForm\" :loading=\"submitting\">保存修改</el-button>\n          <el-button @click=\"resetForm\">重置</el-button>\n          <el-button @click=\"goBack\">返回</el-button>\n        </el-form-item>\n      </el-form>\n    </el-card>\n  </div>\n</template>\n\n<script>\nimport { userAPI } from '../api'\n\nexport default {\n  name: 'UserUpdate',\n  data() {\n    return {\n      userForm: {\n        username: '',\n        name: '',\n        gender: '0',\n        email: '',\n        phone: '',\n      },\n      userRules: {\n        name: [\n          { required: false, max: 50, message: '昵称不能超过50个字符', trigger: 'blur' }\n        ],\n        email: [\n          { required: false, type: 'email', message: '请输入正确的邮箱地址', trigger: 'blur' }\n        ],\n        phone: [\n          { required: false, pattern: /^1[3-9]\\d{9}$/, message: '请输入正确的手机号码', trigger: 'blur' }\n        ],\n        bio: [\n          { required: false, max: 200, message: '个性签名不能超过200个字符', trigger: 'blur' }\n        ]\n      },\n      submitting: false\n    }\n  },\n  mounted() {\n    this.loadUserInfo()\n  },\n  methods: {\n    async loadUserInfo() {\n      try {\n        //获得当前用户的id\n        const userInfoString = localStorage.getItem('userInfo');\n        const userInfo = JSON.parse(userInfoString);\n        const id = userInfo.id;\n        const response = await userAPI.getUserInfo(id)\n        this.userForm = {\n          username: response.username,\n          name: response.name || '',\n          gender: response.gender?.toString() || '0',\n          email: response.email || '',\n          phone: response.phone || '',\n        }\n      } catch (error) {\n        this.$message.error('加载用户信息失败')\n      }\n    },\n    async submitForm() {\n      this.$refs.userFormRef.validate(async (valid) => {\n        if (valid) {\n          this.submitting = true\n          try {\n            //获得当前用户的id\n            const userInfoString = localStorage.getItem('userInfo');\n            const userInfo = JSON.parse(userInfoString);\n            const id = userInfo.id;\n            await userAPI.updateUserInfo(id,this.userForm)\n            this.$message.success('个人信息更新成功')\n            this.$router.push('/user/info')\n          } catch (error) {\n            this.$message.error('更新失败，请重试')\n          } finally {\n            this.submitting = false\n          }\n        }\n      })\n    },\n    resetForm() {\n      this.$refs.userFormRef.resetFields()\n    },\n    goBack() {\n      this.$router.go(-1)\n    }\n  }\n}\n</script>\n\n<style scoped>\n.user-update-container {\n  padding: 0;\n}\n\n.update-card {\n  max-width: 600px;\n  margin: 0 auto;\n}\n\n.card-header {\n  font-size: 18px;\n  font-weight: 500;\n  color: #303133;\n}\n\n.update-form {\n  padding-top: 20px;\n}\n\n@media (max-width: 768px) {\n  .update-card {\n    max-width: 100%;\n  }\n  \n  .el-form {\n    width: 80px;\n  }\n}\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}