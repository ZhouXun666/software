"use strict";(self["webpackChunksecondhand_frontend"]=self["webpackChunksecondhand_frontend"]||[]).push([[902],{552:(e,t,a)=>{a.d(t,{Eo:()=>s,Rv:()=>o,a6:()=>l});var r=a(335);const s={register:e=>r.A.post("/users/register",e),login:e=>r.A.post("/users/login",e),getCurrentUser:()=>r.A.get("/users/me"),updateUser:e=>r.A.put("/users/me",e),getUsers:e=>r.A.get("/users",{params:e})},l={createProduct:e=>r.A.post("/products",e),getProducts:e=>r.A.get("/products",{params:e}),getProductById:e=>r.A.get(`/products/${e}`),updateProduct:(e,t)=>r.A.put(`/products/${e}`,t),deleteProduct:e=>r.A.delete(`/products/${e}`),getMyProducts:()=>r.A.get("/products/my"),searchProducts:e=>r.A.get("/products/search",{params:{keyword:e}})},o={applyTrade:e=>r.A.post("/trades/apply",e),acceptTrade:e=>r.A.post(`/trades/${e}/accept`),rejectTrade:e=>r.A.post(`/trades/${e}/reject`),cancelTrade:e=>r.A.post(`/trades/${e}/cancel`),completeTrade:e=>r.A.post(`/trades/${e}/complete`),getTradeById:e=>r.A.get(`/trades/${e}`),getMyBuyTrades:()=>{const e=JSON.parse(localStorage.getItem("userInfo"));return r.A.get(`/trades/buyer/${e?.id}`)},getMySellTrades:()=>{const e=JSON.parse(localStorage.getItem("userInfo"));return r.A.get(`/trades/seller/${e?.id}`)},getProductTrades:e=>r.A.get(`/trades/product/${e}`)}},902:(e,t,a)=>{a.r(t),a.d(t,{default:()=>_});var r=a(641),s=a(33);const l={class:"index-container"},o={class:"filter-content"},d={class:"sort-container"},c={class:"product-list"},n={class:"product-image"},u=["src","alt"],i={class:"product-info"},p={class:"product-name"},g={class:"product-description"},h={class:"product-meta"},m={class:"product-price"},k={class:"product-date"},y={class:"product-user"},f={class:"pagination"},b={class:"loading-container"};function v(e,t,a,v,C,P){const F=(0,r.g2)("el-input"),A=(0,r.g2)("el-option"),_=(0,r.g2)("el-select"),S=(0,r.g2)("el-button"),$=(0,r.g2)("el-radio-button"),w=(0,r.g2)("el-radio-group"),z=(0,r.g2)("el-card"),L=(0,r.g2)("el-avatar"),I=(0,r.g2)("el-pagination"),T=(0,r.g2)("el-spinner"),V=(0,r.g2)("el-dialog");return(0,r.uX)(),(0,r.CE)("div",l,[(0,r.bF)(z,{class:"filter-card"},{default:(0,r.k6)(()=>[(0,r.Lk)("div",o,[(0,r.bF)(F,{modelValue:e.searchKeyword,"onUpdate:modelValue":t[0]||(t[0]=t=>e.searchKeyword=t),placeholder:"搜索商品名称","prefix-icon":"el-icon-search",class:"search-input",clearable:""},null,8,["modelValue"]),(0,r.bF)(_,{modelValue:C.selectedCategory,"onUpdate:modelValue":t[1]||(t[1]=e=>C.selectedCategory=e),placeholder:"选择分类",clearable:""},{default:(0,r.k6)(()=>[(0,r.bF)(A,{label:"全部分类",value:""}),(0,r.bF)(A,{label:"电子产品",value:"1"}),(0,r.bF)(A,{label:"图书文具",value:"2"}),(0,r.bF)(A,{label:"服装鞋帽",value:"3"}),(0,r.bF)(A,{label:"生活用品",value:"4"}),(0,r.bF)(A,{label:"其他",value:"5"})]),_:1},8,["modelValue"]),(0,r.bF)(S,{type:"primary",onClick:P.handleFilter,size:"default"},{default:(0,r.k6)(()=>[...t[6]||(t[6]=[(0,r.eW)("筛选",-1)])]),_:1},8,["onClick"]),(0,r.bF)(S,{onClick:P.resetFilter,size:"default"},{default:(0,r.k6)(()=>[...t[7]||(t[7]=[(0,r.eW)("重置",-1)])]),_:1},8,["onClick"]),(0,r.Lk)("div",d,[t[12]||(t[12]=(0,r.Lk)("span",null,"排序：",-1)),(0,r.bF)(w,{modelValue:C.sortBy,"onUpdate:modelValue":t[2]||(t[2]=e=>C.sortBy=e),onChange:P.handleSort},{default:(0,r.k6)(()=>[(0,r.bF)($,{label:"default"},{default:(0,r.k6)(()=>[...t[8]||(t[8]=[(0,r.eW)("默认",-1)])]),_:1}),(0,r.bF)($,{label:"price_asc"},{default:(0,r.k6)(()=>[...t[9]||(t[9]=[(0,r.eW)("价格从低到高",-1)])]),_:1}),(0,r.bF)($,{label:"price_desc"},{default:(0,r.k6)(()=>[...t[10]||(t[10]=[(0,r.eW)("价格从高到低",-1)])]),_:1}),(0,r.bF)($,{label:"newest"},{default:(0,r.k6)(()=>[...t[11]||(t[11]=[(0,r.eW)("最新发布",-1)])]),_:1})]),_:1},8,["modelValue","onChange"])])])]),_:1}),(0,r.Lk)("div",c,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(C.products,e=>((0,r.uX)(),(0,r.Wv)(z,{key:e.id,class:"product-card",onClick:t=>P.goToDetail(e.id)},{default:(0,r.k6)(()=>[(0,r.Lk)("div",n,[(0,r.Lk)("img",{src:P.getMainImage(e.images),alt:e.name},null,8,u)]),(0,r.Lk)("div",i,[(0,r.Lk)("h3",p,(0,s.v_)(e.name),1),(0,r.Lk)("p",g,(0,s.v_)(e.description),1),(0,r.Lk)("div",h,[(0,r.Lk)("span",m,"¥"+(0,s.v_)(e.price),1),(0,r.Lk)("span",k,(0,s.v_)(P.formatDate(e.createTime)),1)]),(0,r.Lk)("div",y,[(0,r.bF)(L,{size:20,src:e.userAvatar||""},{default:(0,r.k6)(()=>[(0,r.eW)((0,s.v_)(e.username?.charAt(0)),1)]),_:2},1032,["src"]),(0,r.Lk)("span",null,(0,s.v_)(e.username||"用户"),1)])])]),_:2},1032,["onClick"]))),128))]),(0,r.Lk)("div",f,[(0,r.bF)(I,{"current-page":C.currentPage,"onUpdate:currentPage":t[3]||(t[3]=e=>C.currentPage=e),"page-size":C.pageSize,"onUpdate:pageSize":t[4]||(t[4]=e=>C.pageSize=e),"page-sizes":[12,24,36],layout:"total, sizes, prev, pager, next, jumper",total:C.total,onSizeChange:P.handleSizeChange,onCurrentChange:P.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])]),(0,r.bF)(V,{modelValue:C.loading,"onUpdate:modelValue":t[5]||(t[5]=e=>C.loading=e),title:"",width:"30%","show-close":!1},{default:(0,r.k6)(()=>[(0,r.Lk)("div",b,[(0,r.bF)(T,{type:"spinner"}),t[13]||(t[13]=(0,r.Lk)("p",null,"加载中...",-1))])]),_:1},8,["modelValue"])])}var C=a(552);const P={name:"ProductIndex",data(){return{products:[],total:0,currentPage:1,pageSize:12,selectedCategory:"",sortBy:"default",loading:!1}},mounted(){this.loadProducts(),this.$watch(()=>this.$route.query,e=>{e.keyword&&(this.searchKeyword=e.keyword,this.loadProducts())},{immediate:!0})},methods:{async loadProducts(){this.loading=!0;try{const e={page:this.currentPage,pageSize:this.pageSize,categoryId:this.selectedCategory||void 0,sort:this.sortBy};this.searchKeyword&&(e.keyword=this.searchKeyword);const t=await C.a6.getProducts(e);this.products=t.data||[],this.total=t.total||0}catch(e){this.$message.error("加载商品失败")}finally{this.loading=!1}},handleFilter(){this.currentPage=1,this.loadProducts()},resetFilter(){this.selectedCategory="",this.sortBy="default",this.currentPage=1,this.loadProducts()},handleSort(){this.currentPage=1,this.loadProducts()},handleSizeChange(e){this.pageSize=e,this.loadProducts()},handleCurrentChange(e){this.currentPage=e,this.loadProducts()},goToDetail(e){this.$router.push(`/product/${e}`)},getMainImage(e){if(!e)return"https://via.placeholder.com/400x300?text=No+Image";const t="string"===typeof e?JSON.parse(e):e;return t&&t.length>0?t[0]:"https://via.placeholder.com/400x300?text=No+Image"},formatDate(e){if(!e)return"";const t=new Date(e),a=new Date,r=a-t,s=Math.floor(r/864e5);return 0===s?"今天":1===s?"昨天":s<7?`${s}天前`:`${t.getFullYear()}-${(t.getMonth()+1).toString().padStart(2,"0")}-${t.getDate().toString().padStart(2,"0")}`}}};var F=a(262);const A=(0,F.A)(P,[["render",v],["__scopeId","data-v-7ff857d7"]]),_=A}}]);
//# sourceMappingURL=902.9e5eb179.js.map