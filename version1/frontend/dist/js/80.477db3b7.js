"use strict";(self["webpackChunksecondhand_frontend"]=self["webpackChunksecondhand_frontend"]||[]).push([[80],{80:(e,r,a)=>{a.r(r),a.d(r,{default:()=>m});var t=a(641);const s={class:"user-update-container"};function l(e,r,a,l,o,d){const u=(0,t.g2)("el-input"),n=(0,t.g2)("el-form-item"),m=(0,t.g2)("el-radio"),i=(0,t.g2)("el-radio-group"),c=(0,t.g2)("el-button"),p=(0,t.g2)("el-form"),g=(0,t.g2)("el-card");return(0,t.uX)(),(0,t.CE)("div",s,[(0,t.bF)(g,{class:"update-card"},{header:(0,t.k6)(()=>[...r[6]||(r[6]=[(0,t.Lk)("div",{class:"card-header"},[(0,t.Lk)("span",null,"编辑个人信息")],-1)])]),default:(0,t.k6)(()=>[(0,t.bF)(p,{model:o.userForm,rules:o.userRules,ref:"userFormRef","label-width":"100px",class:"update-form"},{default:(0,t.k6)(()=>[(0,t.bF)(n,{label:"用户名",prop:"username"},{default:(0,t.k6)(()=>[(0,t.bF)(u,{modelValue:o.userForm.username,"onUpdate:modelValue":r[0]||(r[0]=e=>o.userForm.username=e),disabled:"",placeholder:"用户名不可修改"},null,8,["modelValue"])]),_:1}),(0,t.bF)(n,{label:"昵称",prop:"nickname"},{default:(0,t.k6)(()=>[(0,t.bF)(u,{modelValue:o.userForm.nickname,"onUpdate:modelValue":r[1]||(r[1]=e=>o.userForm.nickname=e),placeholder:"请输入昵称",maxlength:"50","show-word-limit":""},null,8,["modelValue"])]),_:1}),(0,t.bF)(n,{label:"性别"},{default:(0,t.k6)(()=>[(0,t.bF)(i,{modelValue:o.userForm.gender,"onUpdate:modelValue":r[2]||(r[2]=e=>o.userForm.gender=e)},{default:(0,t.k6)(()=>[(0,t.bF)(m,{label:"1"},{default:(0,t.k6)(()=>[...r[7]||(r[7]=[(0,t.eW)("男",-1)])]),_:1}),(0,t.bF)(m,{label:"2"},{default:(0,t.k6)(()=>[...r[8]||(r[8]=[(0,t.eW)("女",-1)])]),_:1}),(0,t.bF)(m,{label:"0"},{default:(0,t.k6)(()=>[...r[9]||(r[9]=[(0,t.eW)("保密",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),(0,t.bF)(n,{label:"邮箱",prop:"email"},{default:(0,t.k6)(()=>[(0,t.bF)(u,{modelValue:o.userForm.email,"onUpdate:modelValue":r[3]||(r[3]=e=>o.userForm.email=e),type:"email",placeholder:"请输入邮箱",maxlength:"100","show-word-limit":""},null,8,["modelValue"])]),_:1}),(0,t.bF)(n,{label:"手机号码",prop:"phone"},{default:(0,t.k6)(()=>[(0,t.bF)(u,{modelValue:o.userForm.phone,"onUpdate:modelValue":r[4]||(r[4]=e=>o.userForm.phone=e),placeholder:"请输入手机号码",maxlength:"20","show-word-limit":""},null,8,["modelValue"])]),_:1}),(0,t.bF)(n,{label:"个性签名",prop:"bio"},{default:(0,t.k6)(()=>[(0,t.bF)(u,{modelValue:o.userForm.bio,"onUpdate:modelValue":r[5]||(r[5]=e=>o.userForm.bio=e),type:"textarea",rows:3,placeholder:"请输入个性签名",maxlength:"200","show-word-limit":""},null,8,["modelValue"])]),_:1}),(0,t.bF)(n,null,{default:(0,t.k6)(()=>[(0,t.bF)(c,{type:"primary",onClick:d.submitForm,loading:o.submitting},{default:(0,t.k6)(()=>[...r[10]||(r[10]=[(0,t.eW)("保存修改",-1)])]),_:1},8,["onClick","loading"]),(0,t.bF)(c,{onClick:d.resetForm},{default:(0,t.k6)(()=>[...r[11]||(r[11]=[(0,t.eW)("重置",-1)])]),_:1},8,["onClick"]),(0,t.bF)(c,{onClick:d.goBack},{default:(0,t.k6)(()=>[...r[12]||(r[12]=[(0,t.eW)("返回",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules"])]),_:1})])}var o=a(552);const d={name:"UserUpdate",data(){return{userForm:{username:"",nickname:"",gender:"0",email:"",phone:"",bio:""},userRules:{nickname:[{required:!1,max:50,message:"昵称不能超过50个字符",trigger:"blur"}],email:[{required:!1,type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}],phone:[{required:!1,pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号码",trigger:"blur"}],bio:[{required:!1,max:200,message:"个性签名不能超过200个字符",trigger:"blur"}]},submitting:!1}},mounted(){this.loadUserInfo()},methods:{async loadUserInfo(){try{const e=await o.Eo.getUserInfo();this.userForm={username:e.username,nickname:e.nickname||"",gender:e.gender?.toString()||"0",email:e.email||"",phone:e.phone||"",bio:e.bio||""}}catch(e){this.$message.error("加载用户信息失败")}},async submitForm(){this.$refs.userFormRef.validate(async e=>{if(e){this.submitting=!0;try{await o.Eo.updateUserInfo(this.userForm),this.$message.success("个人信息更新成功"),this.$router.push("/user/info")}catch(r){this.$message.error("更新失败，请重试")}finally{this.submitting=!1}}})},resetForm(){this.$refs.userFormRef.resetFields()},goBack(){this.$router.go(-1)}}};var u=a(262);const n=(0,u.A)(d,[["render",l],["__scopeId","data-v-2681824a"]]),m=n},552:(e,r,a)=>{a.d(r,{Eo:()=>s,Rv:()=>o,a6:()=>l});var t=a(335);const s={register:e=>t.A.post("/users/register",e),login:e=>t.A.post("/users/login",e),getCurrentUser:()=>t.A.get("/users/me"),updateUser:e=>t.A.put("/users/me",e),getUsers:e=>t.A.get("/users",{params:e})},l={createProduct:e=>t.A.post("/products",e),getProducts:e=>t.A.get("/products",{params:e}),getProductById:e=>t.A.get(`/products/${e}`),updateProduct:(e,r)=>t.A.put(`/products/${e}`,r),deleteProduct:e=>t.A.delete(`/products/${e}`),getMyProducts:()=>t.A.get("/products/my"),searchProducts:e=>t.A.get("/products/search",{params:{keyword:e}})},o={applyTrade:e=>t.A.post("/trades/apply",e),acceptTrade:e=>t.A.post(`/trades/${e}/accept`),rejectTrade:e=>t.A.post(`/trades/${e}/reject`),cancelTrade:e=>t.A.post(`/trades/${e}/cancel`),completeTrade:e=>t.A.post(`/trades/${e}/complete`),getTradeById:e=>t.A.get(`/trades/${e}`),getMyBuyTrades:()=>{const e=JSON.parse(localStorage.getItem("userInfo"));return t.A.get(`/trades/buyer/${e?.id}`)},getMySellTrades:()=>{const e=JSON.parse(localStorage.getItem("userInfo"));return t.A.get(`/trades/seller/${e?.id}`)},getProductTrades:e=>t.A.get(`/trades/product/${e}`)}}}]);
//# sourceMappingURL=80.477db3b7.js.map