"use strict";(self["webpackChunksecondhand_frontend"]=self["webpackChunksecondhand_frontend"]||[]).push([[105],{105:(e,t,a)=>{a.r(t),a.d(t,{default:()=>k});var r=a(641),s=a(33);const l={class:"my-products-container"},o={class:"card-header"},d={class:"search-filter"},c={class:"product-name-wrapper"},u=["src"],i={class:"product-name"},n={class:"pagination-container"},p={class:"dialog-footer"};function g(e,t,a,g,h,m){const b=(0,r.g2)("Plus"),y=(0,r.g2)("el-icon"),f=(0,r.g2)("el-button"),k=(0,r.g2)("el-input"),C=(0,r.g2)("el-option"),P=(0,r.g2)("el-select"),F=(0,r.g2)("el-table-column"),w=(0,r.g2)("el-tag"),v=(0,r.g2)("el-table"),_=(0,r.g2)("el-pagination"),S=(0,r.g2)("el-card"),A=(0,r.g2)("el-dialog"),V=(0,r.gN)("loading");return(0,r.uX)(),(0,r.CE)("div",l,[(0,r.bF)(S,{class:"products-card"},{header:(0,r.k6)(()=>[(0,r.Lk)("div",o,[t[8]||(t[8]=(0,r.Lk)("span",null,"我的商品",-1)),(0,r.bF)(f,{type:"primary",onClick:m.goToCreate,class:"create-btn"},{default:(0,r.k6)(()=>[(0,r.bF)(y,null,{default:(0,r.k6)(()=>[(0,r.bF)(b)]),_:1}),t[7]||(t[7]=(0,r.eW)(" 发布商品 ",-1))]),_:1},8,["onClick"])])]),default:(0,r.k6)(()=>[(0,r.Lk)("div",d,[(0,r.bF)(k,{modelValue:h.searchQuery,"onUpdate:modelValue":t[0]||(t[0]=e=>h.searchQuery=e),placeholder:"搜索商品名称","prefix-icon":"el-icon-search",class:"search-input",clearable:""},null,8,["modelValue"]),(0,r.bF)(P,{modelValue:h.productStatus,"onUpdate:modelValue":t[1]||(t[1]=e=>h.productStatus=e),placeholder:"商品状态",clearable:"",class:"status-select"},{default:(0,r.k6)(()=>[(0,r.bF)(C,{label:"全部",value:""}),(0,r.bF)(C,{label:"上架",value:"1"}),(0,r.bF)(C,{label:"下架",value:"0"})]),_:1},8,["modelValue"]),(0,r.bF)(P,{modelValue:h.productCategory,"onUpdate:modelValue":t[2]||(t[2]=e=>h.productCategory=e),placeholder:"商品分类",clearable:"",class:"category-select"},{default:(0,r.k6)(()=>[(0,r.bF)(C,{label:"全部",value:""}),(0,r.bF)(C,{label:"电子产品",value:"1"}),(0,r.bF)(C,{label:"图书文具",value:"2"}),(0,r.bF)(C,{label:"服装鞋帽",value:"3"}),(0,r.bF)(C,{label:"生活用品",value:"4"}),(0,r.bF)(C,{label:"其他",value:"5"})]),_:1},8,["modelValue"])]),(0,r.bo)(((0,r.uX)(),(0,r.Wv)(v,{data:m.filteredProducts,style:{width:"100%"},"empty-text":m.emptyText},{default:(0,r.k6)(()=>[(0,r.bF)(F,{prop:"id",label:"ID",width:"80"}),(0,r.bF)(F,{prop:"name",label:"商品名称","min-width":"200"},{default:(0,r.k6)(e=>[(0,r.Lk)("div",c,[(0,r.Lk)("img",{src:m.getFirstImage(e.row.images),class:"product-thumbnail"},null,8,u),(0,r.Lk)("span",i,(0,s.v_)(e.row.name),1)])]),_:1}),(0,r.bF)(F,{prop:"price",label:"价格",width:"100"},{default:(0,r.k6)(e=>[(0,r.eW)("¥"+(0,s.v_)(e.row.price),1)]),_:1}),(0,r.bF)(F,{prop:"categoryId",label:"分类",width:"120"},{default:(0,r.k6)(e=>[(0,r.eW)((0,s.v_)(m.getCategoryName(e.row.categoryId)),1)]),_:1}),(0,r.bF)(F,{prop:"status",label:"状态",width:"100"},{default:(0,r.k6)(e=>[(0,r.bF)(w,{type:1===e.row.status?"success":"info"},{default:(0,r.k6)(()=>[(0,r.eW)((0,s.v_)(1===e.row.status?"上架":"下架"),1)]),_:2},1032,["type"])]),_:1}),(0,r.bF)(F,{prop:"createdTime",label:"创建时间",width:"180"}),(0,r.bF)(F,{label:"操作",width:"200",fixed:"right"},{default:(0,r.k6)(e=>[(0,r.bF)(f,{type:"primary",size:"small",onClick:t=>m.viewProduct(e.row.id),class:"btn-view"},{default:(0,r.k6)(()=>[...t[9]||(t[9]=[(0,r.eW)(" 查看 ",-1)])]),_:1},8,["onClick"]),(0,r.bF)(f,{type:"warning",size:"small",onClick:t=>m.editProduct(e.row.id),class:"btn-edit"},{default:(0,r.k6)(()=>[...t[10]||(t[10]=[(0,r.eW)(" 编辑 ",-1)])]),_:1},8,["onClick"]),(0,r.bF)(f,{type:"danger",size:"small",onClick:t=>m.deleteProduct(e.row),class:"btn-delete"},{default:(0,r.k6)(()=>[...t[11]||(t[11]=[(0,r.eW)(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data","empty-text"])),[[V,h.loading]]),(0,r.Lk)("div",n,[(0,r.bF)(_,{"current-page":h.currentPage,"onUpdate:currentPage":t[3]||(t[3]=e=>h.currentPage=e),"page-size":h.pageSize,"onUpdate:pageSize":t[4]||(t[4]=e=>h.pageSize=e),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:h.total,onSizeChange:m.handleSizeChange,onCurrentChange:m.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])]),_:1}),(0,r.bF)(A,{modelValue:h.confirmDialogVisible,"onUpdate:modelValue":t[6]||(t[6]=e=>h.confirmDialogVisible=e),title:"确认删除",width:"30%"},{footer:(0,r.k6)(()=>[(0,r.Lk)("span",p,[(0,r.bF)(f,{onClick:t[5]||(t[5]=e=>h.confirmDialogVisible=!1)},{default:(0,r.k6)(()=>[...t[12]||(t[12]=[(0,r.eW)("取消",-1)])]),_:1}),(0,r.bF)(f,{type:"danger",onClick:m.confirmDelete},{default:(0,r.k6)(()=>[...t[13]||(t[13]=[(0,r.eW)("确认删除",-1)])]),_:1},8,["onClick"])])]),default:(0,r.k6)(()=>[t[14]||(t[14]=(0,r.Lk)("div",null,"确定要删除该商品吗？删除后将无法恢复。",-1))]),_:1},8,["modelValue"])])}var h=a(548),m=a(552);const b={name:"MyProducts",components:{Plus:h.FWt},data(){return{products:[],loading:!1,searchQuery:"",productStatus:"",productCategory:"",currentPage:1,pageSize:10,total:0,confirmDialogVisible:!1,deleteProductId:null}},computed:{filteredProducts(){let e=this.products;this.searchQuery&&(e=e.filter(e=>e.name.toLowerCase().includes(this.searchQuery.toLowerCase()))),""!==this.productStatus&&(e=e.filter(e=>e.status.toString()===this.productStatus)),""!==this.productCategory&&(e=e.filter(e=>e.categoryId.toString()===this.productCategory)),this.total=e.length;const t=(this.currentPage-1)*this.pageSize,a=t+this.pageSize;return e.slice(t,a)},emptyText(){return this.loading?"加载中...":"暂无商品"}},mounted(){this.loadMyProducts()},watch:{searchQuery(){this.currentPage=1},productStatus(){this.currentPage=1},productCategory(){this.currentPage=1}},methods:{async loadMyProducts(){this.loading=!0;try{const e=await m.a6.getUserProducts();this.products=e.map(e=>({...e,createdTime:this.formatDate(e.createdTime)}))}catch(e){this.$message.error("加载商品列表失败"),this.products=[]}finally{this.loading=!1}},getFirstImage(e){if(!e)return"https://img.alicdn.com/imgextra/i4/O1CN01q0UcHt1h1sVt0jA8O_!!6000000004122-2-tps-112-112.png";const t="string"===typeof e?JSON.parse(e):e;return t&&t.length>0?t[0]:"https://img.alicdn.com/imgextra/i4/O1CN01q0UcHt1h1sVt0jA8O_!!6000000004122-2-tps-112-112.png"},getCategoryName(e){const t={1:"电子产品",2:"图书文具",3:"服装鞋帽",4:"生活用品",5:"其他"};return t[e]||"未知"},formatDate(e){if(!e)return"";const t=new Date(e);return t.toLocaleString("zh-CN")},goToCreate(){this.$router.push("/product/create")},viewProduct(e){this.$router.push(`/product/${e}`)},editProduct(e){this.$router.push(`/product/update/${e}`)},deleteProduct(e){this.deleteProductId=e.id,this.confirmDialogVisible=!0},async confirmDelete(){this.confirmDialogVisible=!1;try{await m.a6.deleteProduct(this.deleteProductId),this.products=this.products.filter(e=>e.id!==this.deleteProductId),this.$message.success("商品删除成功")}catch(e){this.$message.error("删除失败，请重试")}},handleSizeChange(e){this.pageSize=e},handleCurrentChange(e){this.currentPage=e}}};var y=a(262);const f=(0,y.A)(b,[["render",g],["__scopeId","data-v-2fe688e4"]]),k=f},552:(e,t,a)=>{a.d(t,{Eo:()=>s,Rv:()=>o,a6:()=>l});var r=a(335);const s={register:e=>r.A.post("/users/register",e),login:e=>r.A.post("/users/login",e),getCurrentUser:()=>r.A.get("/users/me"),updateUser:e=>r.A.put("/users/me",e),getUsers:e=>r.A.get("/users",{params:e})},l={createProduct:e=>r.A.post("/products",e),getProducts:e=>r.A.get("/products",{params:e}),getProductById:e=>r.A.get(`/products/${e}`),updateProduct:(e,t)=>r.A.put(`/products/${e}`,t),deleteProduct:e=>r.A.delete(`/products/${e}`),getMyProducts:()=>r.A.get("/products/my"),searchProducts:e=>r.A.get("/products/search",{params:{keyword:e}})},o={applyTrade:e=>r.A.post("/trades/apply",e),acceptTrade:e=>r.A.post(`/trades/${e}/accept`),rejectTrade:e=>r.A.post(`/trades/${e}/reject`),cancelTrade:e=>r.A.post(`/trades/${e}/cancel`),completeTrade:e=>r.A.post(`/trades/${e}/complete`),getTradeById:e=>r.A.get(`/trades/${e}`),getMyBuyTrades:()=>{const e=JSON.parse(localStorage.getItem("userInfo"));return r.A.get(`/trades/buyer/${e?.id}`)},getMySellTrades:()=>{const e=JSON.parse(localStorage.getItem("userInfo"));return r.A.get(`/trades/seller/${e?.id}`)},getProductTrades:e=>r.A.get(`/trades/product/${e}`)}}}]);
//# sourceMappingURL=105.75cec343.js.map