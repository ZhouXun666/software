"use strict";(self["webpackChunksecondhand_frontend"]=self["webpackChunksecondhand_frontend"]||[]).push([[205],{205:(e,r,t)=>{t.r(r),t.d(r,{default:()=>n});var a=t(641);const l={class:"product-create-container"},o=["src"];function s(e,r,t,s,d,i){const c=(0,a.g2)("el-input"),u=(0,a.g2)("el-form-item"),p=(0,a.g2)("el-option"),n=(0,a.g2)("el-select"),g=(0,a.g2)("Plus"),m=(0,a.g2)("el-icon"),b=(0,a.g2)("el-upload"),h=(0,a.g2)("el-dialog"),F=(0,a.g2)("el-button"),f=(0,a.g2)("el-form"),k=(0,a.g2)("el-card");return(0,a.uX)(),(0,a.CE)("div",l,[(0,a.bF)(k,{class:"create-card"},{header:(0,a.k6)(()=>[...r[6]||(r[6]=[(0,a.Lk)("div",{class:"card-header"},"发布二手商品",-1)])]),default:(0,a.k6)(()=>[(0,a.bF)(f,{model:d.productForm,rules:d.productRules,ref:"productFormRef","label-width":"100px",class:"create-form"},{default:(0,a.k6)(()=>[(0,a.bF)(u,{label:"商品名称",prop:"name"},{default:(0,a.k6)(()=>[(0,a.bF)(c,{modelValue:d.productForm.name,"onUpdate:modelValue":r[0]||(r[0]=e=>d.productForm.name=e),placeholder:"请输入商品名称",maxlength:"100","show-word-limit":""},null,8,["modelValue"])]),_:1}),(0,a.bF)(u,{label:"商品分类",prop:"categoryId"},{default:(0,a.k6)(()=>[(0,a.bF)(n,{modelValue:d.productForm.categoryId,"onUpdate:modelValue":r[1]||(r[1]=e=>d.productForm.categoryId=e),placeholder:"请选择商品分类"},{default:(0,a.k6)(()=>[(0,a.bF)(p,{label:"电子产品",value:"1"}),(0,a.bF)(p,{label:"图书文具",value:"2"}),(0,a.bF)(p,{label:"服装鞋帽",value:"3"}),(0,a.bF)(p,{label:"生活用品",value:"4"}),(0,a.bF)(p,{label:"其他",value:"5"})]),_:1},8,["modelValue"])]),_:1}),(0,a.bF)(u,{label:"商品价格",prop:"price"},{default:(0,a.k6)(()=>[(0,a.bF)(c,{modelValue:d.productForm.price,"onUpdate:modelValue":r[2]||(r[2]=e=>d.productForm.price=e),modelModifiers:{number:!0},placeholder:"请输入商品价格","prefix-icon":"el-icon-price-tag"},{prepend:(0,a.k6)(()=>[...r[7]||(r[7]=[(0,a.eW)("¥",-1)])]),_:1},8,["modelValue"])]),_:1}),(0,a.bF)(u,{label:"商品图片",prop:"images"},{default:(0,a.k6)(()=>[(0,a.bF)(b,{"file-list":d.fileList,"onUpdate:fileList":r[3]||(r[3]=e=>d.fileList=e),class:"upload-demo",action:"","auto-upload":!1,"on-change":i.handleFileChange,limit:5,"list-type":"picture-card","on-exceed":i.handleExceed},{tip:(0,a.k6)(()=>[...r[8]||(r[8]=[(0,a.Lk)("div",{class:"el-upload__tip"}," 请上传商品图片，最多5张，单张不超过10MB ",-1)])]),default:(0,a.k6)(()=>[(0,a.bF)(m,null,{default:(0,a.k6)(()=>[(0,a.bF)(g)]),_:1})]),_:1},8,["file-list","on-change","on-exceed"]),(0,a.bF)(h,{modelValue:d.dialogVisible,"onUpdate:modelValue":r[4]||(r[4]=e=>d.dialogVisible=e),title:"预览",width:"800px"},{default:(0,a.k6)(()=>[(0,a.Lk)("img",{src:d.dialogImageUrl,alt:"预览图片",style:{width:"100%"}},null,8,o)]),_:1},8,["modelValue"])]),_:1}),(0,a.bF)(u,{label:"商品描述",prop:"description"},{default:(0,a.k6)(()=>[(0,a.bF)(c,{modelValue:d.productForm.description,"onUpdate:modelValue":r[5]||(r[5]=e=>d.productForm.description=e),type:"textarea",rows:6,placeholder:"请详细描述商品信息，如：品牌、规格、使用时间、成色等",maxlength:"2000","show-word-limit":""},null,8,["modelValue"])]),_:1}),(0,a.bF)(u,null,{default:(0,a.k6)(()=>[(0,a.bF)(F,{type:"primary",onClick:i.submitForm,loading:d.submitting,size:"large"},{default:(0,a.k6)(()=>[...r[9]||(r[9]=[(0,a.eW)("发布商品",-1)])]),_:1},8,["onClick","loading"]),(0,a.bF)(F,{onClick:i.resetForm,size:"large"},{default:(0,a.k6)(()=>[...r[10]||(r[10]=[(0,a.eW)("重置",-1)])]),_:1},8,["onClick"]),(0,a.bF)(F,{onClick:i.goBack,size:"large"},{default:(0,a.k6)(()=>[...r[11]||(r[11]=[(0,a.eW)("返回",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules"])]),_:1})])}var d=t(548),i=t(552);const c={name:"ProductCreate",components:{Plus:d.FWt},data(){return{productForm:{name:"",categoryId:"",price:"",description:"",images:[]},productRules:{name:[{required:!0,message:"请输入商品名称",trigger:"blur"},{min:2,max:100,message:"商品名称长度在 2 到 100 个字符",trigger:"blur"}],categoryId:[{required:!0,message:"请选择商品分类",trigger:"change"}],price:[{required:!0,message:"请输入商品价格",trigger:"blur"},{type:"number",min:.01,message:"价格必须大于0",trigger:"blur"}],description:[{required:!0,message:"请输入商品描述",trigger:"blur"},{min:10,max:2e3,message:"商品描述长度在 10 到 2000 个字符",trigger:"blur"}],images:[{required:!0,message:"请至少上传一张商品图片",trigger:"change"}]},fileList:[],dialogVisible:!1,dialogImageUrl:"",submitting:!1}},methods:{handleFileChange(e,r){this.fileList=r,this.productForm.images=r.map(e=>e.url||URL.createObjectURL(e.raw))},handleExceed(e,r){this.$message.warning(`最多只能上传5张图片，已忽略多余${e.length}张图片`)},handlePictureCardPreview(e){this.dialogImageUrl=e.url||URL.createObjectURL(e.raw),this.dialogVisible=!0},handleRemove(e,r){this.fileList=r,this.productForm.images=r.map(e=>e.url)},async submitForm(){this.$refs.productFormRef.validate(async e=>{if(e){this.submitting=!0;try{const e=new FormData;e.append("name",this.productForm.name),e.append("categoryId",this.productForm.categoryId),e.append("price",this.productForm.price),e.append("description",this.productForm.description),e.append("images",JSON.stringify(this.productForm.images)),await i.a6.createProduct(e),this.$message.success("商品发布成功"),this.$router.push("/user/products")}catch(r){this.$message.error(r.response?.data?.message||"商品发布失败，请重试")}finally{this.submitting=!1}}})},resetForm(){this.$refs.productFormRef.resetFields(),this.fileList=[],this.productForm.images=[]},goBack(){this.$router.go(-1)}}};var u=t(262);const p=(0,u.A)(c,[["render",s],["__scopeId","data-v-14efd8ac"]]),n=p},552:(e,r,t)=>{t.d(r,{Eo:()=>l,Rv:()=>s,a6:()=>o});var a=t(335);const l={register:e=>a.A.post("/users/register",e),login:e=>a.A.post("/users/login",e),getCurrentUser:()=>a.A.get("/users/me"),updateUser:e=>a.A.put("/users/me",e),getUsers:e=>a.A.get("/users",{params:e})},o={createProduct:e=>a.A.post("/products",e),getProducts:e=>a.A.get("/products",{params:e}),getProductById:e=>a.A.get(`/products/${e}`),updateProduct:(e,r)=>a.A.put(`/products/${e}`,r),deleteProduct:e=>a.A.delete(`/products/${e}`),getMyProducts:()=>a.A.get("/products/my"),searchProducts:e=>a.A.get("/products/search",{params:{keyword:e}})},s={applyTrade:e=>a.A.post("/trades/apply",e),acceptTrade:e=>a.A.post(`/trades/${e}/accept`),rejectTrade:e=>a.A.post(`/trades/${e}/reject`),cancelTrade:e=>a.A.post(`/trades/${e}/cancel`),completeTrade:e=>a.A.post(`/trades/${e}/complete`),getTradeById:e=>a.A.get(`/trades/${e}`),getMyBuyTrades:()=>{const e=JSON.parse(localStorage.getItem("userInfo"));return a.A.get(`/trades/buyer/${e?.id}`)},getMySellTrades:()=>{const e=JSON.parse(localStorage.getItem("userInfo"));return a.A.get(`/trades/seller/${e?.id}`)},getProductTrades:e=>a.A.get(`/trades/product/${e}`)}}}]);
//# sourceMappingURL=205.40857567.js.map